appId: nl.huishype.app
---
# 03-search-navigate.yaml — Search for Fixture Property
# Uses the search bar to navigate to a deterministic fixture property
# (Beeldbuisring 41, Eindhoven) seeded by the test fixture script.
# This is a sub-flow; app is on the Map tab.
#
# KNOWN LIMITATION: The GroupPreviewCard is rendered inside a MapLibre
# <Marker> component, which on Android renders as a GL texture — NOT as
# real Android views in the accessibility/view hierarchy. Maestro and
# uiautomator cannot see or interact with Marker children. Preview card
# interaction is tested by Playwright on web. This flow tests search +
# property resolution + bottom sheet peek.

# Tap on the search bar input
- tapOn:
    id: "search-bar-input"
- waitForAnimationToEnd

# Type the fixture address
- inputText: "Beeldbuisring 41 Eindhoven"

# Wait for PDOK search results to appear (network call + debounce)
- extendedWaitUntil:
    visible: ".*Beeldbuisring 41.*"
    timeout: 15000

- takeScreenshot: maestro-screenshots/full_flow_04_search_results

# Tap the matching search result
- tapOn:
    id: "search-result-item"
- waitForAnimationToEnd

# Wait for camera fly-to animation to complete
- waitForAnimationToEnd
- waitForAnimationToEnd
- waitForAnimationToEnd

# After search result tap, the property is resolved and:
# 1. Camera flies to the property (zoom 17)
# 2. GroupPreviewCard appears inside Marker (not accessible to Maestro)
# 3. PropertyBottomSheet peeks at 10% with property data
#
# Wait for the bottom sheet to peek (property data loaded)
# The PropertyBottomSheet renders at index=0 (peek) when property loads
- extendedWaitUntil:
    visible: "Zoom.*"
    timeout: 15000

- takeScreenshot: maestro-screenshots/full_flow_05_property_selected

# Verify the search resolved correctly by checking the address is somewhere on screen
# (this matches search bar input text that persists after result selection)
- assertVisible: ".*Beeldbuisring.*"

- takeScreenshot: maestro-screenshots/full_flow_06_map_at_property
